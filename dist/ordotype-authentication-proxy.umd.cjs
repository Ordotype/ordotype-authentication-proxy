(function(t){typeof define=="function"&&define.amd?define(t):t()})(function(){"use strict";var v=Object.defineProperty;var g=(t,n,a)=>n in t?v(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a;var d=(t,n,a)=>g(t,typeof n!="symbol"?n+"":n,a);const t={LOGOUT:"memberstack.logout",GET_APP:"memberstack.getApp",LOGIN:"memberstack.login"};function n(){window._msConfig||(window._msConfig={preventLogin:!0}),window.$memberstackDom=new Proxy(window.$memberstackDom,{get(r,e){const o=r[e];return typeof o=="function"?async function(...s){var l;if(console.log(`Method ${e} called with arguments: ${JSON.stringify(s)}`),e==="logout"){const i=new Event(t.LOGOUT,{bubbles:!1,cancelable:!1});document.dispatchEvent(i)}if(e==="getApp"){const i=new Event(t.GET_APP,{bubbles:!1,cancelable:!1});document.dispatchEvent(i)}if(e==="loginMemberEmailPassword"){const i=new Event(t.LOGIN,{bubbles:!1,cancelable:!1});return document.dispatchEvent(i),((l=window._msConfig)==null?void 0:l.preventLogin)&&!1}return o.apply(r,s)}:o}})}function a(){const r="_ga_7T2LX34911",e=document.cookie.split("; ");for(const o of e){const[s,l]=o.split("=");if(s===r)return l}throw new Error("Device Id cookie not found")}const u="https://staging-api.ordotype.fr";class f{constructor(){d(this,"headers");const e="pk_sb_e80d8429a51c2ceb0530",o=window.localStorage.getItem("ms_session_id"),s=a();this.headers={"X-Api-Key":e,"X-Session-Id":o??void 0,"X-Device-Id":s??void 0}}async request(e,o="GET",s=null,l={}){const i=`${u}/${e}`,m={"Content-Type":"application/json",...this.headers,...l},w={method:o,headers:m,...s&&{body:JSON.stringify(s)}};try{const c=await fetch(i,w);if(!c.ok)throw new Error(`Error ${c.status}: ${c.statusText}`);return await c.json()}catch(c){throw console.error("API Request Failed:",c),c}}async validateSessionStatus(){try{const e=localStorage.getItem("_ms-mid");return await this.request("validate-session-status","POST",null,{Authorization:`Bearer ${e}`})}catch(e){throw console.error("Session validation failed:",e),e}}}n(),document.addEventListener(t.GET_APP,async()=>{console.log("getApp"),await new f().validateSessionStatus()})});
